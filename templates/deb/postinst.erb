#!/bin/bash

<%- get_services.each do |service| -%>
  # switch based on systemd vs systemv
  #
  <%- if @platform.servicetype == "systemd" -%>
    # TBD
  <%- elsif @platform.servicetype == "sysv" -%>
if [ -x "<%= @platform.servicedir %>/<%= service %>" ]; then
  update-rc.d <%= service %> defaults > /dev/null

  if [ -n "$2" ]; then
    invoke-rc.d <%= service %> condrestart || true
  fi
fi
  <%- end -%>
<%- end -%>

# Set up any specific permissions needed...
<%- get_directories.select { |dir| dir.has_overrides? }.each do |directory| -%>
<%= "chmod '#{directory.mode}' '#{directory.path}'" if directory.mode %>
<%= "chown '#{directory.owner}' '#{directory.path}'" if directory.owner %>
<%= "chgrp '#{directory.group}' '#{directory.path}'" if directory.group %>
<%- end -%>
