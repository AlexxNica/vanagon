%global real_initrddir    %{_initrddir}
%global local_initrddir   %(echo %{_initrddir} | sed 's,^/,,g')

%global _prefix     <%= prefix %>
%global _sysconfdir <%= sysconfdir %>
%global _logdir     <%= logdir %>
%global local_unitdir   %(echo %{_unitdir} | sed 's,^/,,g')

Name:           <%= @name %>
Version:        <%= @version %>
Release:        1
Summary:        <%= @description.lines.first.chomp %>
Vendor:         <%= @vendor.match(/^(.*) <.*>$/)[1] %>
License:        <%= @license %>
Group:          System Environment/Base
URL:            <%= @homepage %>

BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)

Source0:        %{name}-%{version}.tar.gz

# Don't provide anything so the system doesn't use our packages to resolve deps
Autoprov: 0
Autoreq: 0

%description
<%= @description %>

Contains the following components:
<%= @components.map {|comp| "#{comp.name} (#{comp.version})" }.join(", ") %>

%prep
%setup -q -n %{name}-%{version}

%build

%clean

%install
rm -rf %{buildroot}

mkdir -p %{buildroot}%{_sysconfdir}
mkdir -p %{buildroot}%{_prefix}
mkdir -p %{buildroot}%{_logdir}

# Copy each of the extra files into place
<%- get_files.map {|f| f.sub(/^\//,'')}.each do |file| -%>
  install -d %{buildroot}/<%= File.dirname(file) %>
  cp -p <%= file %> %{buildroot}/<%= File.dirname(file) %>
<%- end -%>

cp -pr etc %{buildroot}
cp -pr opt %{buildroot}
cp -pr var %{buildroot}

%files
%{_prefix}
%{_sysconfdir}
%{_logdir}
<%= get_files.join("\n") %>

%changelog
* <%= Time.now.strftime("%a %b %d %Y") %> <%= @vendor %> -  <%= @version %>-1
- Build for <%= @version %>
